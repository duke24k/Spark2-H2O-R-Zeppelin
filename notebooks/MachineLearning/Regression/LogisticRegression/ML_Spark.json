{"id":"2BFAKGNSV","name":"AWS - Machine Learning with Spark","config":{},"info":{},"paragraphs":[{"id":"20160301-231408_1931463034","title":"","text":"%dep\nz.reset()\n// Add spark-csv package\nz.load(\"com.databricks:spark-csv_2.10:1.2.0\")","config":{"colWidth":12.0,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300.0,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1456874048922_-1645266325","result":{"msg":"res0: org.apache.zeppelin.spark.dep.Dependency = org.apache.zeppelin.spark.dep.Dependency@70fb979\n","code":"SUCCESS","type":"TEXT"},"dateCreated":"Mar 1, 2016 11:14:08 PM","dateStarted":"Mar 2, 2016 5:34:42 AM","dateFinished":"Mar 2, 2016 5:34:51 AM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"dateUpdated":"Mar 2, 2016 5:34:42 AM","type":"paragraph","meta":{"notebookId":"1451"},"_id":"8862d1f430b54df6aa8076fb5d37ea10","_rev":"1-0a32935462c1fc0a3f0d08df87ff37dc"},{"id":"20160302-022108_1406459248","title":"","text":"%md\n# Read Data","config":{"colWidth":12.0,"editorMode":"ace/mode/markdown","editorHide":true,"graph":{"mode":"table","height":300.0,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1456885268338_-2056859892","result":{"msg":"<h1>Read Data</h1>\n","code":"SUCCESS","type":"HTML"},"dateCreated":"Mar 2, 2016 2:21:08 AM","dateStarted":"Mar 2, 2016 2:21:34 AM","dateFinished":"Mar 2, 2016 2:21:35 AM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"dateUpdated":"Mar 2, 2016 2:21:45 AM","type":"paragraph","meta":{"notebookId":"1451"},"_id":"7a66322a79d747018c7a042c379d207c","_rev":"1-228c24bf0934609608d841ba3742c366"},{"id":"20160301-224730_1289623525","title":"We will build our engine on smaller data set first","text":"%pyspark\nimport os\ncomplete_dataset_path = 's3://movieslarge'  \nsmall_dataset_path = 's3://moviessmall'\n\nsmall_ratings_file = os.path.join(small_dataset_path, 'ratings.csv')\nsmall_ratings_raw_data = sc.textFile(small_ratings_file)\nsmall_ratings_raw_data_header = small_ratings_raw_data.take(1)[0]\n\nsmall_ratings_file = os.path.join(small_dataset_path, 'ratings.csv')\nsmall_ratings_raw_data = sc.textFile(small_ratings_file)\nsmall_ratings_raw_data_header = small_ratings_raw_data.take(1)[0]\n\n# just to show as DF\nsmall_ratings_raw_data_DF=sqlContext.load(\n source=\"com.databricks.spark.csv\",\n header='true',\n inferSchema='true',\n path=\n small_ratings_file)\nsmall_ratings_raw_data_DF.show(6)\n","config":{"lineNumbers":true,"colWidth":12.0,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300.0,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1456872450351_-887963353","result":{"msg":"/usr/lib/spark/python/pyspark/sql/context.py:538: UserWarning: load is deprecated. Use read.load() instead.\n  warnings.warn(\"load is deprecated. Use read.load() instead.\")\n+------+-------+------+----------+\n|userId|movieId|rating| timestamp|\n+------+-------+------+----------+\n|     1|     16|   4.0|1217897793|\n|     1|     24|   1.5|1217895807|\n|     1|     32|   4.0|1217896246|\n|     1|     47|   4.0|1217896556|\n|     1|     50|   4.0|1217896523|\n|     1|    110|   4.0|1217896150|\n+------+-------+------+----------+\nonly showing top 6 rows\n\n","code":"SUCCESS","type":"TEXT"},"dateCreated":"Mar 1, 2016 10:47:30 PM","dateStarted":"Mar 2, 2016 5:35:07 AM","dateFinished":"Mar 2, 2016 5:35:50 AM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"dateUpdated":"Mar 2, 2016 5:35:07 AM","type":"paragraph","meta":{"notebookId":"1451"},"_id":"7ef240f93c5d42d19439075f82e93719","_rev":"1-d6b0a1148097ee261c56796dc26364a3"},{"id":"20160302-030857_1727785188","title":"Organize Ratings Data for Fancy visualization|","text":"%pyspark\n\nfrom pyspark.sql.types import *\n\ndata = sc.textFile(small_ratings_file)\ndata = data.filter(lambda line: line !=small_ratings_raw_data_header ).map(lambda line: line.split(',')). \\\n        map(lambda x: Row(userId= int(x[0]),movieId= int(x[1]),rating= float(x[2]),timestamp= str(x[3])  ))\ndataDF = sqlContext.createDataFrame(data)\ndataDF.registerTempTable(\"d\")\n","config":{"lineNumbers":true,"colWidth":12.0,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300.0,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1456888137048_1877319084","result":{"msg":"","code":"SUCCESS","type":"TEXT"},"dateCreated":"Mar 2, 2016 3:08:57 AM","dateStarted":"Mar 2, 2016 5:42:55 AM","dateFinished":"Mar 2, 2016 5:42:56 AM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"dateUpdated":"Mar 2, 2016 5:42:55 AM","type":"paragraph","meta":{"notebookId":"1451"},"_id":"60243481475041e9a38b753f585e4b0d","_rev":"1-87014596fdd33d1b6405a806476194a3"},{"id":"20160302-031809_2119765870","title":"Our good old SQL","text":"%sql\nselect movieId,userId, rating from d  limit ${limit=200, 100|300|500|700}","config":{"lineNumbers":true,"colWidth":12.0,"editorMode":"ace/mode/sql","title":true,"graph":{"mode":"multiBarChart","height":300.0,"optionOpen":true,"keys":[{"name":"movieId","index":0.0,"aggr":"sum"}],"values":[{"name":"rating","index":2.0,"aggr":"avg"}],"groups":[{"name":"userId","index":1.0,"aggr":"sum"}],"scatter":{"xAxis":{"name":"movieId","index":0.0,"aggr":"sum"}}}},"settings":{"params":{"limit":"300"},"forms":{"limit":{"name":"limit","defaultValue":"200","options":[{"value":" 100"},{"value":"300"},{"value":"500"},{"value":"700"}],"hidden":false}}},"jobName":"paragraph_1456888689718_961226496","result":{"msg":"movieId\tuserId\trating\n16\t1\t4.0\n24\t1\t1.5\n32\t1\t4.0\n47\t1\t4.0\n50\t1\t4.0\n110\t1\t4.0\n150\t1\t3.0\n161\t1\t4.0\n165\t1\t3.0\n204\t1\t0.5\n223\t1\t4.0\n256\t1\t0.5\n260\t1\t4.5\n261\t1\t1.5\n277\t1\t0.5\n296\t1\t4.0\n318\t1\t4.0\n349\t1\t4.5\n356\t1\t3.0\n377\t1\t2.5\n380\t1\t3.0\n457\t1\t4.0\n480\t1\t3.5\n527\t1\t4.5\n589\t1\t3.5\n590\t1\t3.5\n592\t1\t2.5\n593\t1\t5.0\n597\t1\t3.0\n608\t1\t3.5\n648\t1\t3.5\n719\t1\t0.5\n724\t1\t3.5\n736\t1\t3.0\n780\t1\t3.5\n858\t1\t5.0\n912\t1\t5.0\n968\t1\t4.5\n1061\t1\t4.0\n1089\t1\t4.5\n1136\t1\t5.0\n1196\t1\t4.5\n1198\t1\t4.0\n1210\t1\t4.5\n1213\t1\t5.0\n1220\t1\t4.0\n1221\t1\t5.0\n1222\t1\t5.0\n1233\t1\t4.5\n1243\t1\t3.5\n1258\t1\t4.5\n1265\t1\t3.0\n1267\t1\t4.0\n1270\t1\t3.0\n1287\t1\t4.5\n1580\t1\t3.5\n1617\t1\t3.5\n1721\t1\t1.5\n1923\t1\t1.5\n1961\t1\t3.0\n2021\t1\t4.0\n2028\t1\t4.5\n2105\t1\t1.5\n2161\t1\t1.5\n2194\t1\t4.5\n2396\t1\t4.0\n2407\t1\t2.5\n2455\t1\t2.0\n2467\t1\t4.5\n2502\t1\t4.0\n2542\t1\t4.5\n2571\t1\t4.5\n2628\t1\t3.0\n2716\t1\t3.5\n2728\t1\t5.0\n2762\t1\t3.0\n2858\t1\t4.0\n2947\t1\t3.5\n2959\t1\t5.0\n3256\t1\t5.0\n3421\t1\t4.5\n3578\t1\t4.0\n4011\t1\t4.5\n4027\t1\t3.5\n4033\t1\t3.5\n4085\t1\t3.5\n4262\t1\t5.0\n4306\t1\t4.0\n4963\t1\t3.5\n4993\t1\t4.5\n4995\t1\t4.0\n5349\t1\t3.0\n5378\t1\t3.5\n5418\t1\t4.0\n5445\t1\t3.5\n5952\t1\t4.5\n6365\t1\t4.5\n6711\t1\t3.5\n6807\t1\t4.0\n7153\t1\t4.5\n8825\t1\t2.5\n8961\t1\t4.0\n32587\t1\t4.5\n33493\t1\t4.5\n33794\t1\t4.5\n33834\t1\t4.5\n45950\t1\t0.5\n48516\t1\t5.0\n48780\t1\t4.0\n49272\t1\t3.5\n52973\t1\t3.5\n54286\t1\t4.0\n57949\t1\t0.5\n1\t2\t5.0\n3\t2\t2.0\n5\t2\t3.0\n14\t2\t4.0\n17\t2\t5.0\n25\t2\t3.0\n32\t2\t3.0\n36\t2\t5.0\n52\t2\t4.0\n58\t2\t4.0\n62\t2\t5.0\n79\t2\t4.0\n95\t2\t4.0\n112\t2\t3.0\n260\t2\t4.0\n376\t2\t4.0\n494\t2\t4.0\n608\t2\t5.0\n637\t2\t3.0\n648\t2\t4.0\n661\t2\t4.0\n736\t2\t4.0\n780\t2\t4.0\n784\t2\t2.0\n788\t2\t4.0\n802\t2\t4.0\n805\t2\t5.0\n1073\t2\t4.0\n1356\t2\t4.0\n5\t3\t3.0\n7\t3\t3.0\n11\t3\t4.0\n21\t3\t5.0\n34\t3\t5.0\n36\t3\t4.0\n39\t3\t4.0\n45\t3\t5.0\n50\t3\t5.0\n105\t3\t3.0\n141\t3\t3.0\n144\t3\t4.0\n150\t3\t4.0\n165\t3\t3.0\n185\t3\t3.0\n222\t3\t5.0\n223\t3\t5.0\n232\t3\t4.0\n246\t3\t5.0\n261\t3\t3.0\n272\t3\t5.0\n277\t3\t4.0\n281\t3\t3.0\n292\t3\t3.0\n296\t3\t5.0\n300\t3\t4.0\n339\t3\t3.0\n342\t3\t5.0\n345\t3\t5.0\n348\t3\t3.0\n349\t3\t3.0\n350\t3\t3.0\n356\t3\t3.0\n357\t3\t4.0\n367\t3\t4.0\n368\t3\t3.0\n373\t3\t3.0\n377\t3\t3.0\n380\t3\t3.0\n410\t3\t3.0\n417\t3\t4.0\n454\t3\t3.0\n457\t3\t4.0\n471\t3\t3.0\n477\t3\t4.0\n480\t3\t4.0\n485\t3\t3.0\n497\t3\t4.0\n500\t3\t4.0\n508\t3\t3.0\n509\t3\t5.0\n515\t3\t5.0\n527\t3\t4.0\n529\t3\t5.0\n532\t3\t3.0\n537\t3\t3.0\n538\t3\t4.0\n539\t3\t3.0\n586\t3\t4.0\n587\t3\t3.0\n588\t3\t3.0\n589\t3\t3.0\n590\t3\t4.0\n592\t3\t3.0\n593\t3\t5.0\n595\t3\t4.0\n597\t3\t3.0\n608\t3\t5.0\n613\t3\t4.0\n648\t3\t4.0\n736\t3\t3.0\n800\t3\t5.0\n1161\t3\t4.0\n30\t4\t4.0\n32\t4\t5.0\n111\t4\t4.0\n154\t4\t4.0\n213\t4\t4.0\n296\t4\t4.0\n306\t4\t5.0\n307\t4\t5.0\n308\t4\t5.0\n318\t4\t4.0\n509\t4\t3.0\n527\t4\t4.0\n573\t4\t4.0\n593\t4\t4.0\n608\t4\t4.0\n858\t4\t5.0\n898\t4\t4.0\n899\t4\t5.0\n904\t4\t4.0\n905\t4\t5.0\n909\t4\t4.0\n910\t4\t5.0\n912\t4\t5.0\n913\t4\t5.0\n916\t4\t4.0\n919\t4\t5.0\n922\t4\t5.0\n928\t4\t4.0\n936\t4\t4.0\n937\t4\t5.0\n940\t4\t5.0\n943\t4\t4.0\n945\t4\t4.0\n946\t4\t4.0\n947\t4\t4.0\n951\t4\t5.0\n1085\t4\t5.0\n1094\t4\t4.0\n1176\t4\t4.0\n1185\t4\t4.0\n1186\t4\t3.0\n1196\t4\t4.0\n1203\t4\t5.0\n1204\t4\t5.0\n1207\t4\t5.0\n1209\t4\t4.0\n1219\t4\t3.0\n1224\t4\t4.0\n1225\t4\t5.0\n1230\t4\t4.0\n1233\t4\t5.0\n1244\t4\t4.0\n1247\t4\t4.0\n1250\t4\t5.0\n1252\t4\t4.0\n1254\t4\t5.0\n1256\t4\t5.0\n1267\t4\t3.0\n1276\t4\t5.0\n1277\t4\t4.0\n1281\t4\t5.0\n1283\t4\t4.0\n1284\t4\t4.0\n1296\t4\t4.0\n1333\t4\t3.0\n1358\t4\t4.0\n1392\t4\t4.0\n1412\t4\t4.0\n1446\t4\t4.0\n1511\t4\t3.0\n1617\t4\t4.0\n1633\t4\t5.0\n1719\t4\t5.0\n1732\t4\t2.0\n1734\t4\t4.0\n1931\t4\t4.0\n1936\t4\t5.0\n1944\t4\t3.0\n1945\t4\t4.0\n1948\t4\t4.0\n1949\t4\t5.0\n1997\t4\t5.0\n2019\t4\t4.0\n2132\t4\t5.0\n2160\t4\t4.0\n","code":"SUCCESS","type":"TABLE"},"dateCreated":"Mar 2, 2016 3:18:09 AM","dateStarted":"Mar 2, 2016 5:39:49 AM","dateFinished":"Mar 2, 2016 5:39:49 AM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"dateUpdated":"Mar 2, 2016 5:40:05 AM","type":"paragraph","meta":{"notebookId":"1451"},"_id":"127152a3299b4fab8ec37333234d20d0","_rev":"1-143965f7a3a138f01f9085c23ddd2395"},{"id":"20160301-231244_1287073227","title":"Create RDD which has only 3 columns: userID, movieID, rating (we do not need timestamps)","text":"%pyspark\nsmall_ratings_data = small_ratings_raw_data\\\n    .filter(lambda line: line != small_ratings_raw_data_header)\\\n    .map(lambda line: line.split(\",\"))\\\n    .map(lambda tokens: (tokens[0],tokens[1],tokens[2])).cache()","config":{"lineNumbers":true,"colWidth":12.0,"title":true,"graph":{"mode":"table","height":300.0,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1456873964911_36162989","result":{"msg":"","code":"SUCCESS","type":"TEXT"},"dateCreated":"Mar 1, 2016 11:12:44 PM","dateStarted":"Mar 2, 2016 5:41:59 AM","dateFinished":"Mar 2, 2016 5:41:59 AM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"dateUpdated":"Mar 2, 2016 5:41:59 AM","type":"paragraph","meta":{"notebookId":"1451"},"_id":"dfb67708a6e04f1885c5912f64ea7ef6","_rev":"1-7d11cf4a12185cb3baad6cd6c415436a"},{"id":"20160301-231727_881876057","title":"We also need movie data with movieId, movieTitle and genre. We do not need genre.","text":"%pyspark\nsmall_movies_file = os.path.join(small_dataset_path, 'movies.csv')\n\nsmall_movies_raw_data = sc.textFile(small_movies_file)\nsmall_movies_raw_data_header = small_movies_raw_data.take(1)[0]\n\nsmall_movies_data = small_movies_raw_data\\\n    .filter(lambda line: line != small_movies_raw_data_header)\\\n    .map(lambda line: line.split(\",\"))\\\n    .map(lambda tokens: (tokens[0],tokens[1]))\\\n    .cache()\n\nprint small_movies_data.take(3)","config":{"lineNumbers":true,"colWidth":12.0,"title":true,"graph":{"mode":"table","height":300.0,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1456874247504_1845635422","result":{"msg":"[(u'1', u'Toy Story (1995)'), (u'2', u'Jumanji (1995)'), (u'3', u'Grumpier Old Men (1995)')]\n","code":"SUCCESS","type":"TEXT"},"dateCreated":"Mar 1, 2016 11:17:27 PM","dateStarted":"Mar 2, 2016 5:42:04 AM","dateFinished":"Mar 2, 2016 5:42:17 AM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"dateUpdated":"Mar 2, 2016 5:42:04 AM","type":"paragraph","meta":{"notebookId":"1451"},"_id":"6d61fd3b2a3843a680c8c1e0e5100c27","_rev":"1-d1aa4ea1354961a0994ff14bf7eb74ca"},{"id":"20160302-054234_1530616708","title":"","text":"%pyspark\nsmall_movies_raw_data = sc.textFile(small_movies_file)\n\ndata = small_movies_raw_data.filter(lambda line: line !=small_movies_raw_data_header ).map(lambda line: line.split(',')). \\\n        map(lambda x: Row(movieId= int(x[0]) ,title= (x[1]).encode('utf-8')  ))\ndataDF = sqlContext.createDataFrame(data)\ndataDF.registerTempTable(\"d\")","config":{"colWidth":12.0,"graph":{"mode":"table","height":300.0,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1456897354666_-1266120542","result":{"msg":"","code":"SUCCESS","type":"TEXT"},"dateCreated":"Mar 2, 2016 5:42:34 AM","dateStarted":"Mar 2, 2016 5:54:12 AM","dateFinished":"Mar 2, 2016 5:54:12 AM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"dateUpdated":"Mar 2, 2016 5:54:12 AM","type":"paragraph","meta":{"notebookId":"1451"},"_id":"4fccd319add142a5bbeac6fc5dc9026e","_rev":"1-f6bb162b892180fec18df84aef05d94f"},{"id":"20160302-054749_322716985","title":"","text":"%sql\nselect * from d ","config":{"colWidth":12.0,"editorMode":"ace/mode/sql","graph":{"mode":"table","height":300.0,"optionOpen":false,"keys":[{"name":"movieId","index":0.0,"aggr":"sum"}],"values":[{"name":"title","index":1.0,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"movieId","index":0.0,"aggr":"sum"},"yAxis":{"name":"title","index":1.0,"aggr":"sum"}}}},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1456897669746_-474831617","result":{"msg":"movieId\ttitle\n1\tToy Story (1995)\n2\tJumanji (1995)\n3\tGrumpier Old Men (1995)\n4\tWaiting to Exhale (1995)\n5\tFather of the Bride Part II (1995)\n6\tHeat (1995)\n7\tSabrina (1995)\n8\tTom and Huck (1995)\n9\tSudden Death (1995)\n10\tGoldenEye (1995)\n11\t\"American President\n12\tDracula: Dead and Loving It (1995)\n13\tBalto (1995)\n14\tNixon (1995)\n15\tCutthroat Island (1995)\n16\tCasino (1995)\n17\tSense and Sensibility (1995)\n18\tFour Rooms (1995)\n19\tAce Ventura: When Nature Calls (1995)\n20\tMoney Train (1995)\n21\tGet Shorty (1995)\n22\tCopycat (1995)\n23\tAssassins (1995)\n24\tPowder (1995)\n25\tLeaving Las Vegas (1995)\n26\tOthello (1995)\n27\tNow and Then (1995)\n28\tPersuasion (1995)\n29\t\"City of Lost Children\n30\tShanghai Triad (Yao a yao yao dao waipo qiao) (1995)\n31\tDangerous Minds (1995)\n32\tTwelve Monkeys (a.k.a. 12 Monkeys) (1995)\n33\tWings of Courage (1995)\n34\tBabe (1995)\n35\tCarrington (1995)\n36\tDead Man Walking (1995)\n39\tClueless (1995)\n40\t\"Cry\n41\tRichard III (1995)\n42\tDead Presidents (1995)\n43\tRestoration (1995)\n44\tMortal Kombat (1995)\n45\tTo Die For (1995)\n46\tHow to Make an American Quilt (1995)\n47\tSeven (a.k.a. Se7en) (1995)\n48\tPocahontas (1995)\n49\tWhen Night Is Falling (1995)\n50\t\"Usual Suspects\n52\tMighty Aphrodite (1995)\n53\tLamerica (1994)\n54\t\"Big Green\n55\tGeorgia (1995)\n57\tHome for the Holidays (1995)\n58\t\"Postman\n59\t\"Confessional\n60\t\"Indian in the Cupboard\n61\tEye for an Eye (1996)\n62\tMr. Holland's Opus (1995)\n63\tDon't Be a Menace to South Central While Drinking Your Juice in the Hood (1996)\n64\tTwo if by Sea (1996)\n65\tBio-Dome (1996)\n66\tLawnmower Man 2: Beyond Cyberspace (1996)\n68\tFrench Twist (Gazon maudit) (1995)\n69\tFriday (1995)\n70\tFrom Dusk Till Dawn (1996)\n71\tFair Game (1995)\n72\tKicking and Screaming (1995)\n73\t\"MisÃ©rables\n74\tBed of Roses (1996)\n75\tBig Bully (1996)\n76\tScreamers (1995)\n78\t\"Crossing Guard\n79\t\"Juror\n80\t\"White Balloon\n81\tThings to Do in Denver When You're Dead (1995)\n82\tAntonia's Line (Antonia) (1995)\n83\tOnce Upon a Time... When We Were Colored (1995)\n84\tLast Summer in the Hamptons (1995)\n85\tAngels and Insects (1995)\n86\tWhite Squall (1996)\n87\tDunston Checks In (1996)\n88\tBlack Sheep (1996)\n89\tNick of Time (1995)\n90\t\"Journey of August King\n92\tMary Reilly (1996)\n93\tVampire in Brooklyn (1995)\n94\tBeautiful Girls (1996)\n95\tBroken Arrow (1996)\n96\tIn the Bleak Midwinter (1995)\n97\t\"Hate (Haine\n100\tCity Hall (1996)\n101\tBottle Rocket (1996)\n102\tMr. Wrong (1996)\n103\tUnforgettable (1996)\n104\tHappy Gilmore (1996)\n105\t\"Bridges of Madison County\n107\tMuppet Treasure Island (1996)\n108\tCatwalk (1996)\n110\tBraveheart (1995)\n111\tTaxi Driver (1976)\n112\tRumble in the Bronx (Hont faan kui) (1995)\n113\tBefore and After (1996)\n114\tMargaret's Museum (1995)\n115\t\"Happiness Is in the Field (Bonheur est dans le prÃ©\n116\tAnne Frank Remembered (1995)\n117\t\"Young Poisoner's Handbook\n118\tIf Lucy Fell (1996)\n121\t\"Boys of St. Vincent\n122\tBoomerang (1992)\n123\tChungking Express (Chung Hing sam lam) (1994)\n124\t\"Star Maker\n125\tFlirting With Disaster (1996)\n126\t\"NeverEnding Story III\n129\tPie in the Sky (1996)\n131\tFrankie Starlight (1995)\n132\tJade (1995)\n135\tDown Periscope (1996)\n137\tMan of the Year (1995)\n138\t\"Neon Bible\n140\tUp Close and Personal (1996)\n141\t\"Birdcage\n144\t\"Brothers McMullen\n145\tBad Boys (1995)\n146\t\"Amazing Panda Adventure\n147\t\"Basketball Diaries\n149\tAmateur (1994)\n150\tApollo 13 (1995)\n151\tRob Roy (1995)\n152\t\"Addiction\n153\tBatman Forever (1995)\n154\tBeauty of the Day (Belle de jour) (1967)\n155\tBeyond Rangoon (1995)\n156\tBlue in the Face (1995)\n157\tCanadian Bacon (1995)\n158\tCasper (1995)\n159\tClockers (1995)\n160\tCongo (1995)\n161\tCrimson Tide (1995)\n162\tCrumb (1994)\n163\tDesperado (1995)\n164\tDevil in a Blue Dress (1995)\n165\tDie Hard: With a Vengeance (1995)\n166\t\"Doom Generation\n168\tFirst Knight (1995)\n169\tFree Willy 2: The Adventure Home (1995)\n170\tHackers (1995)\n171\tJeffrey (1995)\n172\tJohnny Mnemonic (1995)\n173\tJudge Dredd (1995)\n174\tJury Duty (1995)\n175\tKids (1995)\n176\tLiving in Oblivion (1995)\n177\tLord of Illusions (1995)\n178\tLove & Human Remains (1993)\n179\tMad Love (1995)\n180\tMallrats (1995)\n181\tMighty Morphin Power Rangers: The Movie (1995)\n182\tMoonlight and Valentino (1995)\n183\tMute Witness (1994)\n184\tNadja (1994)\n185\t\"Net\n186\tNine Months (1995)\n187\tParty Girl (1995)\n188\t\"Prophecy\n190\tSafe (1995)\n191\t\"Scarlet Letter\n193\tShowgirls (1995)\n194\tSmoke (1995)\n195\tSomething to Talk About (1995)\n196\tSpecies (1995)\n198\tStrange Days (1995)\n199\t\"Umbrellas of Cherbourg\n200\t\"Tie That Binds\n201\tThree Wishes (1995)\n202\tTotal Eclipse (1995)\n203\t\"To Wong Foo\n204\tUnder Siege 2: Dark Territory (1995)\n205\tUnstrung Heroes (1995)\n206\tUnzipped (1995)\n207\t\"Walk in the Clouds\n208\tWaterworld (1995)\n209\tWhite Man's Burden (1995)\n210\tWild Bill (1995)\n211\t\"Browning Version\n212\tBushwhacked (1995)\n213\tBurnt by the Sun (Utomlyonnye solntsem) (1994)\n214\tBefore the Rain (Pred dozhdot) (1994)\n215\tBefore Sunrise (1995)\n216\tBilly Madison (1995)\n217\t\"Babysitter\n218\tBoys on the Side (1995)\n219\t\"Cure\n220\tCastle Freak (1995)\n222\tCircle of Friends (1995)\n223\tClerks (1994)\n224\tDon Juan DeMarco (1995)\n225\tDisclosure (1994)\n226\tDream Man (1995)\n227\tDrop Zone (1994)\n228\tDestiny Turns on the Radio (1995)\n229\tDeath and the Maiden (1994)\n230\tDolores Claiborne (1995)\n231\tDumb & Dumber (Dumb and Dumber) (1994)\n232\tEat Drink Man Woman (Yin shi nan nu) (1994)\n233\tExotica (1994)\n234\tExit to Eden (1994)\n235\tEd Wood (1994)\n236\tFrench Kiss (1995)\n237\tForget Paris (1995)\n238\tFar From Home: The Adventures of Yellow Dog (1995)\n239\t\"Goofy Movie\n240\tHideaway (1995)\n241\tFluke (1995)\n242\tFarinelli: il castrato (1994)\n243\tGordy (1995)\n245\tThe Glass Shield (1994)\n246\tHoop Dreams (1994)\n247\tHeavenly Creatures (1994)\n248\tHouseguest (1994)\n249\tImmortal Beloved (1994)\n250\tHeavyweights (Heavy Weights) (1995)\n251\t\"Hunted\n252\tI.Q. (1994)\n253\tInterview with the Vampire: The Vampire Chronicles (1994)\n254\tJefferson in Paris (1995)\n255\t\"Jerky Boys\n256\tJunior (1994)\n257\tJust Cause (1995)\n258\t\"Kid in King Arthur's Court\n259\tKiss of Death (1995)\n260\tStar Wars: Episode IV - A New Hope (1977)\n261\tLittle Women (1994)\n262\t\"Little Princess\n263\tLadybird Ladybird (1994)\n265\tLike Water for Chocolate (Como agua para chocolate) (1992)\n266\tLegends of the Fall (1994)\n267\tMajor Payne (1995)\n268\tLittle Odessa (1994)\n269\tMy Crazy Life (Mi vida loca) (1993)\n270\tLove Affair (1994)\n271\tLosing Isaiah (1995)\n272\t\"Madness of King George\n273\tMary Shelley's Frankenstein (Frankenstein) (1994)\n274\tMan of the House (1995)\n275\tMixed Nuts (1994)\n276\tMilk Money (1994)\n277\tMiracle on 34th Street (1994)\n278\tMiami Rhapsody (1995)\n279\tMy Family (1995)\n280\tMurder in the First (1995)\n281\tNobody's Fool (1994)\n282\tNell (1994)\n283\tNew Jersey Drive (1995)\n288\tNatural Born Killers (1994)\n289\tOnly You (1994)\n290\tOnce Were Warriors (1994)\n291\tPoison Ivy II (1996)\n292\tOutbreak (1995)\n293\tLÃ©on: The Professional (a.k.a. The Professional) (LÃ©on) (1994)\n294\t\"Perez Family\n296\tPulp Fiction (1994)\n298\tPushing Hands (Tui shou) (1992)\n299\tPriest (1994)\n300\tQuiz Show (1994)\n301\tPicture Bride (Bijo photo) (1994)\n302\t\"Queen Margot (Reine Margot\n303\t\"Quick and the Dead\n304\tRoommates (1995)\n305\tReady to Wear (Pret-A-Porter) (1994)\n306\tThree Colors: Red (Trois couleurs: Rouge) (1994)\n307\tThree Colors: Blue (Trois couleurs: Bleu) (1993)\n308\tThree Colors: White (Trzy kolory: Bialy) (1994)\n309\t\"Red Firecracker\n312\tStuart Saves His Family (1995)\n313\t\"Swan Princess\n314\t\"Secret of Roan Inish\n315\t\"Specialist\n316\tStargate (1994)\n317\t\"Santa Clause\n318\t\"Shawshank Redemption\n319\tShallow Grave (1994)\n320\tSuture (1993)\n321\tStrawberry and Chocolate (Fresa y chocolate) (1993)\n322\tSwimming with Sharks (1995)\n324\t\"Sum of Us\n325\tNational Lampoon's Senior Trip (1995)\n326\tTo Live (Huozhe) (1994)\n327\tTank Girl (1995)\n328\tTales from the Crypt Presents: Demon Knight (1995)\n329\tStar Trek: Generations (1994)\n330\tTales from the Hood (1995)\n331\tTom & Viv (1994)\n332\tVillage of the Damned (1995)\n333\tTommy Boy (1995)\n334\tVanya on 42nd Street (1994)\n335\tUnderneath (1995)\n336\t\"Walking Dead\n337\tWhat's Eating Gilbert Grape (1993)\n338\tVirtuosity (1995)\n339\tWhile You Were Sleeping (1995)\n340\t\"War\n341\tDouble Happiness (1994)\n342\tMuriel's Wedding (1994)\n343\t\"Baby-Sitters Club\n344\tAce Ventura: Pet Detective (1994)\n345\t\"Adventures of Priscilla\n346\tBackbeat (1993)\n347\tBitter Moon (1992)\n348\tBullets Over Broadway (1994)\n349\tClear and Present Danger (1994)\n350\t\"Client\n351\t\"Corrina\n352\tCrooklyn (1994)\n353\t\"Crow\n354\tCobb (1994)\n355\t\"Flintstones\n356\tForrest Gump (1994)\n357\tFour Weddings and a Funeral (1994)\n358\tHigher Learning (1995)\n360\tI Love Trouble (1994)\n361\tIt Could Happen to You (1994)\n362\t\"Jungle Book\n363\t\"Wonderful\n364\t\"Lion King\n365\tLittle Buddha (1993)\n366\t\"Wes Craven's New Nightmare (Nightmare on Elm Street Part 7: Freddy's Finale\n367\t\"Mask\n368\tMaverick (1994)\n369\tMrs. Parker and the Vicious Circle (1994)\n370\tNaked Gun 33 1/3: The Final Insult (1994)\n371\t\"Paper\n372\tReality Bites (1994)\n373\tRed Rock West (1992)\n374\tRichie Rich (1994)\n375\tSafe Passage (1994)\n376\t\"River Wild\n377\tSpeed (1994)\n378\tSpeechless (1994)\n379\tTimecop (1994)\n380\tTrue Lies (1994)\n381\tWhen a Man Loves a Woman (1994)\n382\tWolf (1994)\n383\tWyatt Earp (1994)\n384\tBad Company (1995)\n385\t\"Man of No Importance\n386\tS.F.W. (1994)\n387\t\"Low Down Dirty Shame\n388\tBoys Life (1995)\n389\t\"Colonel Chabert\n390\tFaster Pussycat! Kill! Kill! (1965)\n391\tJason's Lyric (1994)\n392\t\"Secret Adventures of Tom Thumb\n393\tStreet Fighter (1994)\n396\tFall Time (1995)\n404\tBrother Minister: The Assassination of Malcolm X (1994)\n405\tHighlander III: The Sorcerer (a.k.a. Highlander: The Final Dimension) (1994)\n407\tIn the Mouth of Madness (1995)\n408\t8 Seconds (1994)\n409\tAbove the Rim (1994)\n410\tAddams Family Values (1993)\n412\t\"Age of Innocence\n413\tAirheads (1994)\n414\t\"Air Up There\n415\tAnother Stakeout (1993)\n416\tBad Girls (1994)\n417\tBarcelona (1994)\n418\tBeing Human (1993)\n419\t\"Beverly Hillbillies\n420\tBeverly Hills Cop III (1994)\n421\tBlack Beauty (1994)\n422\tBlink (1994)\n423\tBlown Away (1994)\n424\tBlue Chips (1994)\n425\tBlue Sky (1994)\n426\tBody Snatchers (1993)\n427\tBoxing Helena (1993)\n428\t\"Bronx Tale\n429\tCabin Boy (1994)\n430\tCalendar Girl (1993)\n431\tCarlito's Way (1993)\n432\tCity Slickers II: The Legend of Curly's Gold (1994)\n433\tClean Slate (1994)\n434\tCliffhanger (1993)\n435\tConeheads (1993)\n436\tColor of Night (1994)\n437\tCops and Robbersons (1994)\n438\t\"Cowboy Way\n439\tDangerous Game (1993)\n440\tDave (1993)\n441\tDazed and Confused (1993)\n442\tDemolition Man (1993)\n443\t\"Endless Summer 2\n444\tEven Cowgirls Get the Blues (1993)\n445\tFatal Instinct (1993)\n446\tFarewell My Concubine (Ba wang bie ji) (1993)\n447\t\"Favor\n448\tFearless (1993)\n449\tFear of a Black Hat (1994)\n450\tWith Honors (1994)\n451\tFlesh and Bone (1993)\n452\tWidows' Peak (1994)\n453\tFor Love or Money (1993)\n454\t\"Firm\n455\tFree Willy (1993)\n456\tFresh (1994)\n457\t\"Fugitive\n458\tGeronimo: An American Legend (1993)\n459\t\"Getaway\n460\tGetting Even with Dad (1994)\n461\tGo Fish (1994)\n463\tGuilty as Sin (1993)\n464\tHard Target (1993)\n465\tHeaven & Earth (1993)\n466\tHot Shots! Part Deux (1993)\n467\tLive Nude Girls (1995)\n468\t\"Englishman Who Went Up a Hill But Came Down a Mountain\n469\t\"House of the Spirits\n470\tHouse Party 3 (1994)\n471\t\"Hudsucker Proxy\n472\tI'll Do Anything (1994)\n473\tIn the Army Now (1994)\n474\tIn the Line of Fire (1993)\n475\tIn the Name of the Father (1993)\n476\t\"Inkwell\n477\tWhat's Love Got to Do with It? (1993)\n479\tJudgment Night (1993)\n480\tJurassic Park (1993)\n481\tKalifornia (1993)\n482\tKilling Zoe (1994)\n483\tKing of the Hill (1993)\n485\tLast Action Hero (1993)\n486\tLife with Mikey (1993)\n487\tLightning Jack (1994)\n488\tM. Butterfly (1993)\n489\tMade in America (1993)\n490\tMalice (1993)\n491\t\"Man Without a Face\n492\tManhattan Murder Mystery (1993)\n493\tMenace II Society (1993)\n494\tExecutive Decision (1996)\n495\tIn the Realm of the Senses (Ai no corrida) (1976)\n496\tWhat Happened Was... (1994)\n497\tMuch Ado About Nothing (1993)\n498\tMr. Jones (1993)\n499\tMr. Wonderful (1993)\n500\tMrs. Doubtfire (1993)\n501\tNaked (1993)\n502\t\"Next Karate Kid\n504\tNo Escape (1994)\n505\tNorth (1994)\n506\tOrlando (1992)\n507\t\"Perfect World\n508\tPhiladelphia (1993)\n509\t\"Piano\n510\tPoetic Justice (1993)\n511\t\"Program\n512\t\"Puppet Masters\n513\tRadioland Murders (1994)\n514\t\"Ref\n515\t\"Remains of the Day\n516\tRenaissance Man (1994)\n517\tRising Sun (1993)\n518\t\"Road to Wellville\n519\tRoboCop 3 (1993)\n520\tRobin Hood: Men in Tights (1993)\n521\tRomeo Is Bleeding (1993)\n522\tRomper Stomper (1992)\n523\tRuby in Paradise (1993)\n524\tRudy (1993)\n525\t\"Saint of Fort Washington\n526\t\"Savage Nights (Nuits fauves\n527\tSchindler's List (1993)\n528\t\"Scout\n529\tSearching for Bobby Fischer (1993)\n531\t\"Secret Garden\n532\tSerial Mom (1994)\n533\t\"Shadow\n534\tShadowlands (1993)\n535\tShort Cuts (1993)\n536\t\"Simple Twist of Fate\n537\tSirens (1994)\n538\tSix Degrees of Separation (1993)\n539\tSleepless in Seattle (1993)\n540\tSliver (1993)\n541\tBlade Runner (1982)\n542\tSon in Law (1993)\n543\tSo I Married an Axe Murderer (1993)\n544\tStriking Distance (1993)\n545\tHarem (1985)\n546\tSuper Mario Bros. (1993)\n547\tSurviving the Game (1994)\n548\tTerminal Velocity (1994)\n549\tThirty-Two Short Films About Glenn Gould (1993)\n550\tThreesome (1994)\n551\t\"Nightmare Before Christmas\n552\t\"Three Musketeers\n553\tTombstone (1993)\n554\tTrial by Jury (1994)\n555\tTrue Romance (1993)\n556\t\"War Room\n558\t\"Pagemaster\n560\t\"Beans of Egypt\n562\tWelcome to the Dollhouse (1995)\n563\tGerminal (1993)\n565\tCronos (1993)\n566\tNaked in New York (1994)\n567\tKika (1993)\n568\tBhaji on the Beach (1993)\n569\tLittle Big League (1994)\n570\t\"Slingshot\n571\t\"Wedding Gift\n573\t\"Ciao\n574\tSpanking the Monkey (1994)\n575\t\"Little Rascals\n577\tAndre (1994)\n580\tPrincess Caraboo (1994)\n581\t\"Celluloid Closet\n583\tDear Diary (Caro Diario) (1994)\n585\t\"Brady Bunch Movie\n586\tHome Alone (1990)\n587\tGhost (1990)\n588\tAladdin (1992)\n589\tTerminator 2: Judgment Day (1991)\n590\tDances with Wolves (1990)\n592\tBatman (1989)\n593\t\"Silence of the Lambs\n594\tSnow White and the Seven Dwarfs (1937)\n595\tBeauty and the Beast (1991)\n596\tPinocchio (1940)\n597\tPretty Woman (1990)\n599\t\"Wild Bunch\n600\tLove and a .45 (1994)\n601\t\"Wooden Man's Bride\n602\t\"Great Day in Harlem\n603\t\"Bye Bye\n605\tOne Fine Day (1996)\n606\tCandyman: Farewell to the Flesh (1995)\n608\tFargo (1996)\n609\tHomeward Bound II: Lost in San Francisco (1996)\n610\tHeavy Metal (1981)\n611\tHellraiser: Bloodline (1996)\n612\t\"Pallbearer\n613\tJane Eyre (1996)\n614\tLoaded (1994)\n615\tBread and Chocolate (Pane e cioccolata) (1973)\n616\t\"Aristocats\n617\t\"Flower of My Secret\n618\tTwo Much (1995)\n619\tEd (1996)\n621\tMy Favorite Season (1993)\n626\t\"Thin Line Between Love and Hate\n627\t\"Last Supper\n628\tPrimal Fear (1996)\n630\tCarried Away (1996)\n631\tAll Dogs Go to Heaven 2 (1996)\n632\tLand and Freedom (Tierra y libertad) (1995)\n633\tDenise Calls Up (1995)\n634\tTheodore Rex (1995)\n635\t\"Family Thing\n637\tSgt. Bilko (1996)\n638\tJack and Sarah (1995)\n639\tGirl 6 (1996)\n640\tDiabolique (1996)\n647\tCourage Under Fire (1996)\n648\tMission: Impossible (1996)\n649\tCold Fever (Ã kÃ¶ldum klaka) (1995)\n650\tMoll Flanders (1996)\n653\tDragonheart (1996)\n656\tEddie (1996)\n659\tPurple Noon (Plein soleil) (1960)\n660\tAugust (1996)\n661\tJames and the Giant Peach (1996)\n662\tFear (1996)\n663\tKids in the Hall: Brain Candy (1996)\n664\tFaithful (1996)\n665\tUnderground (1995)\n667\tBloodsport 2 (a.k.a. Bloodsport II: The Next Kumite) (1996)\n668\tSong of the Little Road (Pather Panchali) (1955)\n670\t\"World of Apu\n671\tMystery Science Theater 3000: The Movie (1996)\n673\tSpace Jam (1996)\n674\tBarbarella (1968)\n678\tSome Folks Call It a Sling Blade (1993)\n679\t\"Run of the Country\n680\t\"Alphaville (Alphaville\n681\tCoup de torchon (Clean Slate) (1981)\n685\tIt's My Party (1996)\n688\tOperation Dumbo Drop (1995)\n690\t\"Promise\n691\tMrs. Winterbourne (1996)\n692\tSolo (1996)\n694\t\"Substitute\n695\tTrue Crime (1996)\n697\tFeeling Minnesota (1996)\n700\tAngus (1995)\n702\tFaces (1968)\n703\tBoys (1996)\n704\t\"Quest\n705\tCosi (1996)\n706\tSunset Park (1996)\n707\tMulholland Falls (1996)\n708\t\"Truth About Cats & Dogs\n709\tOliver & Company (1988)\n710\tCeltic Pride (1996)\n711\tFlipper (1996)\n712\tCaptives (1994)\n714\tDead Man (1995)\n715\t\"Horseman on the Roof\n716\tSwitchblade Sisters (1975)\n718\t\"Visitors\n719\tMultiplicity (1996)\n720\tWallace & Gromit: The Best of Aardman Animation (1996)\n722\t\"Haunted World of Edward D. Wood Jr.\n724\t\"Craft\n725\t\"Great White Hype\n726\tLast Dance (1996)\n728\tCold Comfort Farm (1995)\n731\tHeaven's Prisoners (1996)\n732\tOriginal Gangstas (1996)\n733\t\"Rock\n735\tCemetery Man (Dellamorte Dellamore) (1994)\n736\tTwister (1996)\n737\tBarb Wire (1996)\n741\tGhost in the Shell (KÃ´kaku kidÃ´tai) (1995)\n742\tThinner (1996)\n743\tSpy Hard (1996)\n745\tWallace & Gromit: A Close Shave (1995)\n746\tForce of Evil (1948)\n747\t\"Stupids\n748\t\"Arrival\n750\tDr. Strangelove or: How I Learned to Stop Worrying and Love the Bomb (1964)\n753\t\"Month by the Lake\n754\tGold Diggers: The Secret of Bear Mountain (1995)\n755\tKim (1950)\n757\tAshes of Time (Dung che sai duk) (1994)\n759\tMaya Lin: A Strong Clear Vision (1994)\n760\tStalingrad (1993)\n761\t\"Phantom\n762\tStriptease (1996)\n764\tHeavy (1995)\n765\tJack (1996)\n766\tI Shot Andy Warhol (1996)\n767\t\"Grass Harp\n769\tMarlene Dietrich: Shadow and Light (1996)\n778\tTrainspotting (1996)\n779\t'Til There Was You (1997)\n780\tIndependence Day (a.k.a. ID4) (1996)\n781\tStealing Beauty (1996)\n782\t\"Fan\n783\t\"Hunchback of Notre Dame\n784\t\"Cable Guy\n785\tKingpin (1996)\n786\tEraser (1996)\n788\t\"Nutty Professor\n798\tDaylight (1996)\n799\t\"Frighteners\n800\tLone Star (1996)\n801\tHarriet the Spy (1996)\n802\tPhenomenon (1996)\n803\tWalking and Talking (1996)\n804\tShe's the One (1996)\n805\t\"Time to Kill\n806\tAmerican Buffalo (1996)\n807\t\"Rendezvous in Paris (Rendez-vous de Paris\n808\tAlaska (1996)\n809\tFled (1996)\n810\tKazaam (1996)\n813\tLarger Than Life (1996)\n818\t\"Very Brady Sequel\n823\t\"Collector\n824\tKaspar Hauser (1993)\n827\t\"Convent\n828\t\"Adventures of Pinocchio\n829\tJoe's Apartment (1996)\n830\t\"First Wives Club\n831\tStonewall (1995)\n832\tRansom (1996)\n833\tHigh School High (1996)\n834\tPhat Beach (1996)\n835\tFoxfire (1996)\n836\tChain Reaction (1996)\n837\tMatilda (1996)\n838\tEmma (1996)\n839\t\"Crow: City of Angels\n840\tHouse Arrest (1996)\n841\t\"Eyes Without a Face (Yeux sans visage\n842\tTales from the Crypt Presents: Bordello of Blood (1996)\n844\t\"Story of Xinghua\n846\tFlirt (1995)\n848\t\"Spitfire Grill\n849\tEscape from L.A. (1996)\n850\tCyclo (Xich lo) (1995)\n851\tBasquiat (1996)\n852\tTin Cup (1996)\n854\t\"Ballad of Narayama\n858\t\"Godfather\n861\tSupercop (Police Story 3: Supercop) (Jing cha gu shi III: Chao ji jing cha) (1992)\n862\tManny & Lo (1996)\n865\tSmall Faces (1996)\n866\tBound (1996)\n867\tCarpool (1996)\n868\tDeath in Brunswick (1991)\n869\tKansas City (1996)\n870\tGone Fishin' (1997)\n875\tNothing to Lose (1994)\n876\tSupercop 2 (Project S) (Chao ji ji hua) (1993)\n879\t\"Relic\n880\t\"Island of Dr. Moreau\n881\tFirst Kid (1996)\n882\t\"Trigger Effect\n885\tBogus (1996)\n886\tBulletproof (1996)\n888\tLand Before Time III: The Time of the Great Giving (1995)\n890\tBaton Rouge (BÃ¢ton rouge) (1988)\n891\tHalloween: The Curse of Michael Myers (Halloween 6: The Curse of Michael Myers) (1995)\n892\tTwelfth Night (1996)\n893\tMother Night (1996)\n896\tWild Reeds (Les roseaux sauvages) (1994)\n897\tFor Whom the Bell Tolls (1943)\n898\t\"Philadelphia Story\n899\tSingin' in the Rain (1952)\n900\t\"American in Paris\n901\tFunny Face (1957)\n902\tBreakfast at Tiffany's (1961)\n903\tVertigo (1958)\n904\tRear Window (1954)\n905\tIt Happened One Night (1934)\n906\tGaslight (1944)\n907\t\"Gay Divorcee\n908\tNorth by Northwest (1959)\n909\t\"Apartment\n910\tSome Like It Hot (1959)\n911\tCharade (1963)\n912\tCasablanca (1942)\n913\t\"Maltese Falcon\n914\tMy Fair Lady (1964)\n915\tSabrina (1954)\n916\tRoman Holiday (1953)\n917\t\"Little Princess\n918\tMeet Me in St. Louis (1944)\n919\t\"Wizard of Oz\n920\tGone with the Wind (1939)\n921\tMy Favorite Year (1982)\n922\tSunset Blvd. (a.k.a. Sunset Boulevard) (1950)\n923\tCitizen Kane (1941)\n924\t2001: A Space Odyssey (1968)\n926\tAll About Eve (1950)\n927\t\"Women\n928\tRebecca (1940)\n929\tForeign Correspondent (1940)\n930\tNotorious (1946)\n931\tSpellbound (1945)\n932\t\"Affair to Remember\n933\tTo Catch a Thief (1955)\n934\tFather of the Bride (1950)\n935\t\"Band Wagon\n936\tNinotchka (1939)\n937\tLove in the Afternoon (1957)\n938\tGigi (1958)\n939\t\"Reluctant Debutante\n940\t\"Adventures of Robin Hood\n941\t\"Mark of Zorro\n942\tLaura (1944)\n943\t\"Ghost and Mrs. Muir\n944\tLost Horizon (1937)\n945\tTop Hat (1935)\n946\tTo Be or Not to Be (1942)\n947\tMy Man Godfrey (1936)\n948\tGiant (1956)\n949\tEast of Eden (1955)\n950\t\"Thin Man\n951\tHis Girl Friday (1940)\n952\tAround the World in 80 Days (1956)\n953\tIt's a Wonderful Life (1946)\n954\tMr. Smith Goes to Washington (1939)\n955\tBringing Up Baby (1938)\n956\tPenny Serenade (1941)\n957\t\"Scarlet Letter\n958\tLady of Burlesque (1943)\n959\tOf Human Bondage (1934)\n960\tAngel on My Shoulder (1946)\n961\tLittle Lord Fauntleroy (1936)\n963\t\"Inspector General\n964\tAngel and the Badman (1947)\n965\t\"39 Steps\n966\t\"Walk in the Sun\n967\t\"Outlaw\n968\tNight of the Living Dead (1968)\n969\t\"African Queen\n970\tBeat the Devil (1953)\n971\tCat on a Hot Tin Roof (1958)\n972\t\"Last Time I Saw Paris\n973\tMeet John Doe (1941)\n974\tAlgiers (1938)\n976\t\"Farewell to Arms\n979\tNothing Personal (1995)\n980\t\"Yes\n981\tDangerous Ground (1997)\n982\tPicnic (1955)\n986\tFly Away Home (1996)\n987\tBliss (1997)\n988\tGrace of My Heart (1996)\n990\tMaximum Risk (1996)\n991\tMichael Collins (1996)\n993\tInfinity (1996)\n994\tBig Night (1996)\n996\tLast Man Standing (1996)\n997\tCaught (1996)\n998\tSet It Off (1996)\n999\t2 Days in the Valley (1996)\n1000\tCurdled (1996)\n1003\tExtreme Measures (1996)\n1004\t\"Glimmer Man\n1005\tD3: The Mighty Ducks (1996)\n1006\t\"Chamber\n1007\t\"Apple Dumpling Gang\n1008\t\"Davy Crockett\n1009\tEscape to Witch Mountain (1975)\n1010\t\"Love Bug\n1011\tHerbie Rides Again (1974)\n1012\tOld Yeller (1957)\n1013\t\"Parent Trap\n1014\tPollyanna (1960)\n1015\tHomeward Bound: The Incredible Journey (1993)\n1016\t\"Shaggy Dog\n1017\tSwiss Family Robinson (1960)\n1018\tThat Darn Cat! (1965)\n1019\t\"20\n1020\tCool Runnings (1993)\n1021\tAngels in the Outfield (1994)\n1022\tCinderella (1950)\n1023\tWinnie the Pooh and the Blustery Day (1968)\n1024\t\"Three Caballeros\n1025\t\"Sword in the Stone\n1027\tRobin Hood: Prince of Thieves (1991)\n1028\tMary Poppins (1964)\n1029\tDumbo (1941)\n1030\tPete's Dragon (1977)\n1031\tBedknobs and Broomsticks (1971)\n1032\tAlice in Wonderland (1951)\n1033\t\"Fox and the Hound\n1034\tFreeway (1996)\n1035\t\"Sound of Music\n1036\tDie Hard (1988)\n1037\t\"Lawnmower Man\n1038\tUnhook the Stars (1996)\n1040\t\"Secret Agent\n1041\tSecrets & Lies (1996)\n1042\tThat Thing You Do! (1996)\n1043\tTo Gillian on Her 37th Birthday (1996)\n1044\tSurviving Picasso (1996)\n1046\tBeautiful Thing (1996)\n1047\t\"Long Kiss Goodnight\n1049\t\"Ghost and the Darkness\n1050\tLooking for Richard (1996)\n1051\tTrees Lounge (1996)\n1053\tNormal Life (1996)\n1054\tGet on the Bus (1996)\n1056\tJude (1996)\n1057\tEveryone Says I Love You (1996)\n1058\tBitter Sugar (AzÃºcar amarga) (1996)\n1059\tWilliam Shakespeare's Romeo + Juliet (1996)\n1060\tSwingers (1996)\n1061\tSleepers (1996)\n1063\tJohns (1996)\n1064\tAladdin and the King of Thieves (1996)\n1066\tShall We Dance (1937)\n1067\t\"Damsel in Distress\n1068\tCrossfire (1947)\n1069\t\"Murder\n1070\tMacao (1952)\n1071\tFor the Moment (1994)\n1073\tWilly Wonka & the Chocolate Factory (1971)\n1076\t\"Innocents\n1077\tSleeper (1973)\n1078\tBananas (1971)\n1079\t\"Fish Called Wanda\n1080\tMonty Python's Life of Brian (1979)\n1081\tVictor/Victoria (1982)\n1082\t\"Candidate\n1083\t\"Great Race\n1084\tBonnie and Clyde (1967)\n1085\t\"Old Man and the Sea\n1086\tDial M for Murder (1954)\n1087\tMadame Butterfly (1995)\n1088\tDirty Dancing (1987)\n1089\tReservoir Dogs (1992)\n1090\tPlatoon (1986)\n1091\tWeekend at Bernie's (1989)\n1092\tBasic Instinct (1992)\n1093\t\"Doors\n1094\t\"Crying Game\n1095\tGlengarry Glen Ross (1992)\n1096\tSophie's Choice (1982)\n1097\tE.T. the Extra-Terrestrial (1982)\n1099\t\"Christmas Carol\n1100\tDays of Thunder (1990)\n1101\tTop Gun (1986)\n1103\tRebel Without a Cause (1955)\n1104\t\"Streetcar Named Desire\n1105\tChildren of the Corn IV: The Gathering (1996)\n1111\tMicrocosmos (Microcosmos: Le peuple de l'herbe) (1996)\n1112\tPalookaville (1996)\n1113\t\"Associate\n1114\t\"Funeral\n1116\t\"Single Girl\n1117\t\"Eighth Day\n1119\tDrunks (1995)\n1120\t\"People vs. Larry Flynt\n1121\tGlory Daze (1995)\n1123\t\"Perfect Candidate\n1124\tOn Golden Pond (1981)\n1125\t\"Return of the Pink Panther\n1126\tDrop Dead Fred (1991)\n1127\t\"Abyss\n1128\t\"Fog\n1129\tEscape from New York (1981)\n1130\t\"Howling\n1131\tJean de Florette (1986)\n1132\tManon of the Spring (Manon des sources) (1986)\n1133\tTalking About Sex (1994)\n1135\tPrivate Benjamin (1980)\n1136\tMonty Python and the Holy Grail (1975)\n1145\tSnowriders (1996)\n1147\tWhen We Were Kings (1996)\n1148\tWallace & Gromit: The Wrong Trousers (1993)\n1150\t\"Return of Martin Guerre\n1152\tHe Walked by Night (1948)\n1153\tRaw Deal (1948)\n1154\tT-Men (1947)\n1156\t\"Children Are Watching Us\n1161\t\"Tin Drum\n1162\t\"Ruling Class\n1167\tDear God (1996)\n1168\tBad Moon (1996)\n1169\tAmerican Dream (1990)\n1170\tBest of the Best 3: No Turning Back (1995)\n1171\tBob Roberts (1992)\n1172\tCinema Paradiso (Nuovo cinema Paradiso) (1989)\n1173\t\"Cook the Thief His Wife & Her Lover\n1175\tDelicatessen (1991)\n1176\t\"Double Life of Veronique\n1177\tEnchanted April (1992)\n1178\tPaths of Glory (1957)\n1179\t\"Grifters\n1180\tHear My Song (1991)\n1183\t\"English Patient\n1184\tMediterraneo (1991)\n1185\tMy Left Foot (1989)\n1186\t\"Sex\n1187\tPassion Fish (1992)\n1188\tStrictly Ballroom (1992)\n1189\t\"Thin Blue Line\n1190\tTie Me Up! Tie Me Down! (Â¡Ãtame!) (1990)\n1191\tMadonna: Truth or Dare (1991)\n1192\tParis Is Burning (1990)\n1193\tOne Flew Over the Cuckoo's Nest (1975)\n1194\tCheech and Chong's Up in Smoke (1978)\n1196\tStar Wars: Episode V - The Empire Strikes Back (1980)\n1197\t\"Princess Bride\n1198\tRaiders of the Lost Ark (Indiana Jones and the Raiders of the Lost Ark) (1981)\n1199\tBrazil (1985)\n1200\tAliens (1986)\n1201\t\"Good\n1202\tWithnail & I (1987)\n1203\t12 Angry Men (1957)\n1204\tLawrence of Arabia (1962)\n1206\t\"Clockwork Orange\n1207\tTo Kill a Mockingbird (1962)\n1208\tApocalypse Now (1979)\n1209\tOnce Upon a Time in the West (C'era una volta il West) (1968)\n1210\tStar Wars: Episode VI - Return of the Jedi (1983)\n1211\t\"Wings of Desire (Himmel Ã¼ber Berlin\n1212\t\"Third Man\n1213\tGoodfellas (1990)\n1214\tAlien (1979)\n1215\tArmy of Darkness (1993)\n1216\t\"Big Blue\n1217\tRan (1985)\n1218\t\"Killer\n1219\tPsycho (1960)\n1220\t\"Blues Brothers\n1221\t\"Godfather: Part II\n1222\tFull Metal Jacket (1987)\n1223\t\"Grand Day Out with Wallace and Gromit\n1224\tHenry V (1989)\n1225\tAmadeus (1984)\n1226\t\"Quiet Man\n1227\tOnce Upon a Time in America (1984)\n1228\tRaging Bull (1980)\n1230\tAnnie Hall (1977)\n1231\t\"Right Stuff\n1232\tStalker (1979)\n1233\t\"Boot\n1234\t\"Sting\n1235\tHarold and Maude (1971)\n1236\tTrust (1990)\n1237\t\"Seventh Seal\n1238\tLocal Hero (1983)\n1240\t\"Terminator\n\n<font color=red>Results are limited by 1000.</font>","code":"SUCCESS","type":"TABLE"},"dateCreated":"Mar 2, 2016 5:47:49 AM","dateStarted":"Mar 2, 2016 5:54:16 AM","dateFinished":"Mar 2, 2016 5:54:16 AM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"dateUpdated":"Mar 2, 2016 5:54:27 AM","type":"paragraph","meta":{"notebookId":"1451"},"_id":"6b3cd2a4bc3d49f8928d07b4df76b1bf","_rev":"1-5e0e7753a759ac8f0e12013990bca6d5"},{"id":"20160301-231745_301791691","title":"Split our datasets into training, validation and test sets.","text":"%pyspark\ntraining_RDD, validation_RDD, test_RDD = small_ratings_data.randomSplit([6, 2, 2], seed=0L)\nvalidation_for_predict_RDD = validation_RDD.map(lambda x: (x[0], x[1]))\ntest_for_predict_RDD = test_RDD.map(lambda x: (x[0], x[1]))","config":{"lineNumbers":true,"colWidth":12.0,"title":true,"graph":{"mode":"table","height":300.0,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1456874265712_-595764915","result":{"msg":"","code":"SUCCESS","type":"TEXT"},"dateCreated":"Mar 1, 2016 11:17:45 PM","dateStarted":"Mar 2, 2016 5:54:51 AM","dateFinished":"Mar 2, 2016 5:54:51 AM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"dateUpdated":"Mar 2, 2016 5:54:51 AM","type":"paragraph","meta":{"notebookId":"1451"},"_id":"5c89a39f8ac14315a8a60eb58859b928","_rev":"1-912ba6267c8a20b7da6846580d5c9f70"},{"id":"20160301-231807_1356499716","title":"Run the recommendation package for different parameters","text":"%pyspark\nimport math\nfrom pyspark.mllib.recommendation import ALS\n\nseed = 5L\niterations = 10\nregularization_parameter = 0.1\nranks = [4, 8, 12]\nerrors = [0, 0, 0]\nerr = 0\ntolerance = 0.02\n\nmin_error = float('inf')\nbest_rank = -1\nbest_iteration = -1\nfor rank in ranks:\n    model = ALS.train(training_RDD, rank, seed=seed, iterations=iterations,\n                      lambda_=regularization_parameter)\n    predictions = model.predictAll(validation_for_predict_RDD).map(lambda r: ((r[0], r[1]), r[2]))\n    rates_and_preds = validation_RDD.map(lambda r: ((int(r[0]), int(r[1])), float(r[2]))).join(predictions)\n    error = math.sqrt(rates_and_preds.map(lambda r: (r[1][0] - r[1][1])**2).mean())\n    errors[err] = error\n    err += 1\n    print 'For rank %s the RMSE is %s' % (rank, error)\n    if error < min_error:\n        min_error = error\n        best_rank = rank\n\nprint 'The best model was trained with rank %s' % best_rank","config":{"lineNumbers":true,"colWidth":12.0,"title":true,"graph":{"mode":"table","height":300.0,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1456874287707_-2042774880","result":{"msg":"For rank 4 the RMSE is 0.915547266182\nFor rank 8 the RMSE is 0.931249518515\nFor rank 12 the RMSE is 0.928572268558\nThe best model was trained with rank 4\n","code":"SUCCESS","type":"TEXT"},"dateCreated":"Mar 1, 2016 11:18:07 PM","dateStarted":"Mar 2, 2016 5:54:58 AM","dateFinished":"Mar 2, 2016 5:55:22 AM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"dateUpdated":"Mar 2, 2016 5:54:58 AM","type":"paragraph","meta":{"notebookId":"1451"},"_id":"b8e85fd2cd144f92a31dfcaac974268b","_rev":"1-5fd59175a1025284611e8db7cbbd2907"},{"id":"20160301-231928_193266173","title":"Run recommendation with best parameters for test data","text":"%pyspark\nmodel = ALS.train(training_RDD, best_rank, seed=seed, iterations=iterations,\n                      lambda_=regularization_parameter)\n\npredictions = model.predictAll(test_for_predict_RDD)\\\n    .map(lambda r: ((r[0], r[1]), r[2]))\n    \nrates_and_preds = test_RDD\\\n    .map(lambda r: ((int(r[0]), int(r[1])), float(r[2])))\\\n    .join(predictions)\n    \nerror = math.sqrt(rates_and_preds.map(lambda r: (r[1][0] - r[1][1])**2).mean())\n\nprint 'For testing data the RMSE is %s' % (error)","config":{"lineNumbers":true,"colWidth":12.0,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300.0,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1456874368531_-1465712826","result":{"msg":"For testing data the RMSE is 0.922312540228\n","code":"SUCCESS","type":"TEXT"},"dateCreated":"Mar 1, 2016 11:19:28 PM","dateStarted":"Mar 2, 2016 5:55:37 AM","dateFinished":"Mar 2, 2016 5:55:42 AM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"dateUpdated":"Mar 2, 2016 5:55:37 AM","type":"paragraph","meta":{"notebookId":"1451"},"_id":"acc6812e6ac145c2b395e716efe58c1e","_rev":"1-6175d87d3b77903ab70c1681acb86a76"},{"id":"20160301-231827_1362138283","title":"Let's load the complete data set","text":"%pyspark\ncomplete_movies_file = os.path.join(complete_dataset_path, 'movies.csv')\ncomplete_movies_raw_data = sc.textFile(complete_movies_file)\ncomplete_movies_raw_data_header = complete_movies_raw_data.take(1)[0]\n\n# Parse\ncomplete_movies_data = complete_movies_raw_data\\\n    .filter(lambda line: line != complete_movies_raw_data_header)\\\n    .map(lambda line: line.split(\",\"))\\\n    .map(lambda tokens: (int(tokens[0]),tokens[1],tokens[2])).cache()\n\ncomplete_movies_titles = complete_movies_data.map(lambda x: (int(x[0]),x[1]))\n\nprint \"There are %s movies in the complete dataset\" % (complete_movies_titles.count())\n\ncomplete_ratings_file = os.path.join(complete_dataset_path, 'ratings.csv')\ncomplete_ratings_raw_data = sc.textFile(complete_ratings_file)\ncomplete_ratings_raw_data_header = complete_ratings_raw_data.take(1)[0]\n\ncomplete_ratings_data = complete_ratings_raw_data \\\n    .filter(lambda line: line != complete_ratings_raw_data_header)\\\n    .map(lambda line: line.split(\",\"))\\\n    .map(lambda tokens: (int(tokens[0]),int(tokens[1]),float(tokens[2])))\\\n    .cache()\n\nprint \"There are %s recommendations in the complete dataset\" % (complete_ratings_data.count())","config":{"lineNumbers":true,"colWidth":12.0,"title":true,"graph":{"mode":"table","height":300.0,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1456874307486_808629867","result":{"msg":"There are 34208 movies in the complete dataset\nThere are 22884377 recommendations in the complete dataset\n","code":"SUCCESS","type":"TEXT"},"dateCreated":"Mar 1, 2016 11:18:27 PM","dateStarted":"Mar 2, 2016 5:56:00 AM","dateFinished":"Mar 2, 2016 5:58:29 AM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"dateUpdated":"Mar 2, 2016 5:56:00 AM","type":"paragraph","meta":{"notebookId":"1451"},"_id":"6eaee3e02f0145658457cae594fc68cb","_rev":"1-2db83672495c4e6003a53f3503488543"},{"id":"20160301-232206_920439751","title":"","text":"%pyspark\ndef get_counts_and_averages(ID_and_ratings_tuple):\n    nratings = len(ID_and_ratings_tuple[1])\n    return ID_and_ratings_tuple[0], (nratings, float(sum(x for x in ID_and_ratings_tuple[1]))/nratings)\n\nmovie_ID_with_ratings_RDD = (complete_ratings_data.map(lambda x: (x[1], x[2])).groupByKey())\nmovie_ID_with_avg_ratings_RDD = movie_ID_with_ratings_RDD.map(get_counts_and_averages)\nmovie_rating_counts_RDD = movie_ID_with_avg_ratings_RDD.map(lambda x: (x[0], x[1][0]))","config":{"lineNumbers":true,"colWidth":12.0,"graph":{"mode":"table","height":300.0,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1456874526155_987075091","result":{"msg":"","code":"SUCCESS","type":"TEXT"},"dateCreated":"Mar 1, 2016 11:22:06 PM","dateStarted":"Mar 2, 2016 6:01:41 AM","dateFinished":"Mar 2, 2016 6:01:41 AM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"dateUpdated":"Mar 2, 2016 6:01:41 AM","type":"paragraph","meta":{"notebookId":"1451"},"_id":"a2b648ae4537486eb6acb836caa60bc2","_rev":"1-ebe418d1956005f3fb945d2009d6f772"},{"id":"20160301-232519_984610337","title":"pick out some movies you like","text":"%pyspark\nnew_user_ID = 0\n\n# The format of each line is (userID, movieID, rating)\nnew_user_ratings = [\n    (0,921,4), \n    (0,272,3), \n    (0,296,4), \n    (0,300,5), \n    (0,305,3), \n    (0,370,2), \n    (0,441,3), \n    (0,468,3), \n    (0,680,2), \n    (0,750,4), \n    (0,778,4), \n    (0,908,4), \n    (0,921,3),\n    ]\nnew_user_ratings_RDD = sc.parallelize(new_user_ratings)\nprint 'New user ratings: %s' % new_user_ratings_RDD.take(10)","config":{"lineNumbers":true,"colWidth":12.0,"title":true,"graph":{"mode":"table","height":300.0,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1456874719097_-1785562877","result":{"msg":"New user ratings: [(0, 921, 4), (0, 272, 3), (0, 296, 4), (0, 300, 5), (0, 305, 3), (0, 370, 2), (0, 441, 3), (0, 468, 3), (0, 680, 2), (0, 750, 4)]\n","code":"SUCCESS","type":"TEXT"},"dateCreated":"Mar 1, 2016 11:25:19 PM","dateStarted":"Mar 2, 2016 6:02:42 AM","dateFinished":"Mar 2, 2016 6:02:43 AM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"dateUpdated":"Mar 2, 2016 6:02:42 AM","type":"paragraph","meta":{"notebookId":"1451"},"_id":"b89412a8dac5404392e2c95fa4fecfa5","_rev":"1-d07005ab01985e3b789d3af1e40a22a5"},{"id":"20160301-232536_501729412","title":"oin your ratings with the complete ratings file","text":"%pyspark\ncomplete_data_with_new_ratings_RDD = small_ratings_data.union(new_user_ratings_RDD)","config":{"lineNumbers":true,"colWidth":12.0,"title":true,"graph":{"mode":"table","height":300.0,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1456874736956_1509072603","result":{"msg":"","code":"SUCCESS","type":"TEXT"},"dateCreated":"Mar 1, 2016 11:25:36 PM","dateStarted":"Mar 2, 2016 6:03:25 AM","dateFinished":"Mar 2, 2016 6:03:25 AM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"dateUpdated":"Mar 2, 2016 6:03:25 AM","type":"paragraph","meta":{"notebookId":"1451"},"_id":"474bbe2398344ae9bd2d9725805cac0c","_rev":"1-0876d6f1306d6525ff88965fcb05c005"},{"id":"20160301-232552_1355190579","title":"re-train the model using the updated data set","text":"%pyspark\nfrom time import time\n\nt0 = time()\nnew_ratings_model = ALS.train(complete_data_with_new_ratings_RDD, best_rank, seed=seed, \n                              iterations=iterations, lambda_=regularization_parameter)\ntt = time() - t0\n\nprint \"New model trained in %s seconds\" % round(tt,3)","config":{"lineNumbers":true,"colWidth":12.0,"title":true,"graph":{"mode":"table","height":300.0,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1456874752635_-423890547","result":{"msg":"New model trained in 20.412 seconds\n","code":"SUCCESS","type":"TEXT"},"dateCreated":"Mar 1, 2016 11:25:52 PM","dateStarted":"Mar 2, 2016 6:04:02 AM","dateFinished":"Mar 2, 2016 6:04:23 AM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"dateUpdated":"Mar 2, 2016 6:04:02 AM","type":"paragraph","meta":{"notebookId":"1451"},"_id":"3f8de412252e4b3990d89613f396b6b9","_rev":"1-9d56d6ab904acfd75cc705a3baf5ba55"},{"id":"20160301-232612_1536413366","title":"Movies that the new user did not rate","text":"%pyspark\nnew_user_ratings_ids = map(lambda x: x[1], new_user_ratings) # get just movie IDs\n\nnew_user_unrated_movies_RDD = complete_movies_data\\\n.filter(lambda x: x[0] not in new_user_ratings_ids)\\\n.map(lambda x: (new_user_ID, x[0]))\n\nprint new_user_unrated_movies_RDD.count()","config":{"lineNumbers":true,"colWidth":12.0,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300.0,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1456874772551_-652031320","result":{"msg":"34196\n","code":"SUCCESS","type":"TEXT"},"dateCreated":"Mar 1, 2016 11:26:12 PM","dateStarted":"Mar 2, 2016 6:09:28 AM","dateFinished":"Mar 2, 2016 6:09:28 AM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"dateUpdated":"Mar 2, 2016 6:09:28 AM","type":"paragraph","meta":{"notebookId":"1451"},"_id":"e0b2bebb2cf845d989b9a0d051fd81c0","_rev":"1-88bd80f7e70bf77c8b4ed4af415ceaa8"},{"id":"20160302-061152_1693913591","title":"Predict New Ratings","text":"%pyspark\nnew_user_recommendations_RDD = new_ratings_model.predictAll(new_user_unrated_movies_RDD)","config":{"lineNumbers":true,"colWidth":12.0,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300.0,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1456899112207_994945287","result":{"msg":"","code":"SUCCESS","type":"TEXT"},"dateCreated":"Mar 2, 2016 6:11:52 AM","dateStarted":"Mar 2, 2016 6:13:17 AM","dateFinished":"Mar 2, 2016 6:13:17 AM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"dateUpdated":"Mar 2, 2016 6:13:17 AM","type":"paragraph","meta":{"notebookId":"1451"},"_id":"8f17334d7e49458282082f4b2afad178","_rev":"1-170b19d7370f60b7dcef76470d8c9cd6"},{"id":"20160302-061559_1797829499","title":"","text":"%pyspark\nprint new_user_recommendations_RDD.take(5)","config":{"colWidth":12.0,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300.0,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1456899359456_-177416905","result":{"msg":"[Rating(user=0, product=1053, rating=2.530033841765782), Rating(user=0, product=7020, rating=3.3762418336672955), Rating(user=0, product=8370, rating=3.3696568067220944), Rating(user=0, product=79830, rating=4.037528916760024), Rating(user=0, product=450, rating=2.332797551265095)]\n","code":"SUCCESS","type":"TEXT"},"dateCreated":"Mar 2, 2016 6:15:59 AM","dateStarted":"Mar 2, 2016 6:16:20 AM","dateFinished":"Mar 2, 2016 6:16:21 AM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"dateUpdated":"Mar 2, 2016 6:16:20 AM","type":"paragraph","meta":{"notebookId":"1451"},"_id":"8b0a62c7e5ab408396254e610fa2d0f7","_rev":"1-86242eb4353b3a3bed8e694a69598f53"},{"id":"20160302-061228_1621791199","title":"Transform new_user_recommendations_RDD into pairs of the form (Movie ID, Predicted Rating)","text":"%pyspark\nnew_user_recommendations_rating_RDD = new_user_recommendations_RDD.map(lambda x: (x.product, x.rating))\nnew_user_recommendations_rating_title_and_count_RDD = \\\n    new_user_recommendations_rating_RDD.join(complete_movies_titles).join(movie_rating_counts_RDD)","config":{"lineNumbers":true,"colWidth":12.0,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300.0,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1456899148384_905360090","result":{"msg":"","code":"SUCCESS","type":"TEXT"},"dateCreated":"Mar 2, 2016 6:12:28 AM","dateStarted":"Mar 2, 2016 6:17:20 AM","dateFinished":"Mar 2, 2016 6:17:20 AM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"dateUpdated":"Mar 2, 2016 6:17:20 AM","type":"paragraph","meta":{"notebookId":"1451"},"_id":"ea6bed582a6f44a5bb73eaa6bc696b98","_rev":"1-fcff5bf0b554d616148825d0c67a761c"},{"id":"20160302-061812_2052283482","title":"","text":"%pyspark\nprint new_user_recommendations_rating_title_and_count_RDD.take(6)","config":{"colWidth":12.0,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300.0,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1456899492407_-518873069","result":{"msg":"[(122892, ((2.7485719590389808, u'Avengers: Age of Ultron (2015)'), 2552)), (32781, ((2.2430716917883506, u'Hawaii (1966)'), 50)), (21, ((3.0553914345428943, u'Get Shorty (1995)'), 25141)), (8232, ((3.1403002646500733, u'I Love You Again (1940)'), 67)), (42, ((2.9401751068835056, u'Dead Presidents (1995)'), 2549)), (8253, ((3.0084736571248065, u'Lupin III: The Castle Of Cagliostro (Rupan sansei: Kariosutoro no shiro) (1979)'), 983))]\n","code":"SUCCESS","type":"TEXT"},"dateCreated":"Mar 2, 2016 6:18:12 AM","dateStarted":"Mar 2, 2016 6:18:25 AM","dateFinished":"Mar 2, 2016 6:18:51 AM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"dateUpdated":"Mar 2, 2016 6:18:25 AM","type":"paragraph","meta":{"notebookId":"1451"},"_id":"dad5096869664172869e73a387354d8f","_rev":"1-e2f603e2fbf6d23e40204bdbd0a86818"},{"id":"20160302-061712_1931264239","title":"Finally, display some movies that might appeal to you!","text":"%pyspark\nnew_user_recommendations_rating_title_and_count_RDD =\\\n    new_user_recommendations_rating_title_and_count_RDD\\\n    .map(lambda r: (r[1][0][1], r[1][0][0], r[1][1]))\n\ntop_movies = new_user_recommendations_rating_title_and_count_RDD\\\n    .filter(lambda r: r[2]>=25)\\\n    .takeOrdered(25, key=lambda x: -x[1])\n\nprint ('Recommended movies for you (with more than 25 reviews):\\n%s' %\n        '\\n'.join(map(str, top_movies)))","config":{"lineNumbers":true,"colWidth":12.0,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300.0,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1456899432827_660489579","result":{"msg":"Recommended movies for you (with more than 25 reviews):\n(u'Children of Paradise (Les enfants du paradis) (1945)', 4.915008809963158, 1092)\n(u'\"Plague Dogs', 4.704703364755122, 58)\n(u'Grand Illusion (La grande illusion) (1937)', 4.666401262065962, 1673)\n(u'Barenaked in America (1999)', 4.651622985799904, 132)\n(u'\"Civil War', 4.564780925109744, 347)\n(u'Head-On (Gegen die Wand) (2004)', 4.558513579017433, 759)\n(u'Never Let Me Go (2010)', 4.520815435306318, 1065)\n(u'Beautiful People (1999)', 4.5190352713515995, 280)\n(u'\"Angel at My Table', 4.5190352713515995, 197)\n(u'\"Magic Flute', 4.515217883757795, 185)\n(u'Recount (2008)', 4.499727092660608, 317)\n(u'\"Gunfighter', 4.486143383576701, 106)\n(u'Olive Kitteridge (2014)', 4.486143383576701, 92)\n(u'\"Rome', 4.486143383576701, 519)\n(u'Prisoner of the Mountains (Kavkazsky plennik) (1996)', 4.4728942365410145, 289)\n(u'\"After Dark', 4.46917259434915, 175)\n(u'Get Real (1998)', 4.468282495307173, 644)\n(u'Shivers (They Came from Within) (1975)', 4.46548311416996, 221)\n(u\"Waiting for 'Superman' (2010)\", 4.43063122334858, 283)\n(u'21 Up (1977)', 4.417610844803763, 443)\n(u'\"Lawless Heart', 4.416737367698774, 86)\n(u'Hamlet (1948)', 4.40143629201811, 883)\n(u'Until the End of the World (Bis ans Ende der Welt) (1991)', 4.393115869469618, 1111)\n(u'Memories (Memor\\xeezu) (1995)', 4.388762375542852, 299)\n(u'\"Celebration', 4.370221699115509, 2495)\n","code":"SUCCESS","type":"TEXT"},"dateCreated":"Mar 2, 2016 6:17:12 AM","dateStarted":"Mar 2, 2016 6:21:32 AM","dateFinished":"Mar 2, 2016 6:21:33 AM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"dateUpdated":"Mar 2, 2016 6:21:32 AM","type":"paragraph","meta":{"notebookId":"1451"},"_id":"80e92360f57b435390d8b0211a0a22b5","_rev":"1-f59716822fa6cabccdc2dd6a8088aeed"},{"id":"20160302-062132_1870849530","title":"","text":"","config":{},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1456899692778_-249104438","result":"","dateCreated":"Mar 2, 2016 6:21:32 AM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"type":"paragraph","meta":{"notebookId":"1451"},"_id":"2ce977b24b354488b2b12c8f7d1e0f37","_rev":"1-2e9f758a51d4e01914fa09a6ef8f0f38"}],"angularObjects":{"2AJXGMUUJ":[],"2AK8P7CPX":[],"2AM1YV5CU":[],"2AKK3QQXU":[],"2ANGGHHMQ":[]},"meta":{"owner":"sergulaydore","origin":"","instance":379,"runnable":false,"lastUpdate":"2016-07-14 08:10:28.105","history":[],"customConfig":{},"public":true},"type":"notebook","_id":"1451"}